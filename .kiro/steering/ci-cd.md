# üöÄ CI/CD –∏ Deployment —á–µ—Ä–µ–∑ GitHub Actions

## GitHub Actions Workflows

### –û—Å–Ω–æ–≤–Ω–æ–π workflow: Deploy to VPS (deploy.yml)

**–¢—Ä–∏–≥–≥–µ—Ä:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π: `push` –≤ –≤–µ—Ç–∫—É `main`
- –†—É—á–Ω–æ–π: –∫–Ω–æ–ø–∫–∞ "Run workflow" –≤ GitHub Actions

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. **Checkout** –∫–æ–¥–∞ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. **Setup Node.js 20** —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º npm
3. **npm ci** - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
4. **npm run build** - —Å–±–æ—Ä–∫–∞ Vite + esbuild
5. **–°–æ–∑–¥–∞–Ω–∏–µ deployment –∞—Ä—Ö–∏–≤–∞** (dist/, package.json, package-lock.json)
6. **–ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ SSH** –Ω–∞ —Å–µ—Ä–≤–µ—Ä –≤ `/tmp/`
7. **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   - –°–æ–∑–¥–∞–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ backup —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏
   - –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
   - `npm ci --omit=dev` - —É—Å—Ç–∞–Ω–æ–≤–∫–∞ production –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
   - –°–æ–∑–¥–∞–Ω–∏–µ `.env` —Ñ–∞–π–ª–∞ (–µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
   - `systemctl restart parrot-shop` - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
8. **Health check** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ `/api/products`
9. **Telegram notification** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
10. **Cleanup** SSH –∫–ª—é—á–∞

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~3-5 –º–∏–Ω—É—Ç

**–õ–æ–≥–∏:** GitHub ‚Üí Actions ‚Üí Deploy to VPS ‚Üí –≤—ã–±—Ä–∞—Ç—å –∑–∞–ø—É—Å–∫ ‚Üí –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –∫–∞–∂–¥–æ–≥–æ step

---

### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π workflow: Deploy Images Only (deploy-images.yml)

**–¢—Ä–∏–≥–≥–µ—Ä:** –¢–æ–ª—å–∫–æ –≤—Ä—É—á–Ω—É—é (`workflow_dispatch`)

**–ó–∞—á–µ–º:** –ó–∞–≥—Ä—É–∑–∫–∞ 115MB –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –æ—Ç–¥–µ–ª—å–Ω–æ (–Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–µ–ø–ª–æ–µ)

**–û–ø—Ü–∏–∏:**
- `incremental` - –¥–æ–±–∞–≤–∏—Ç—å/–æ–±–Ω–æ–≤–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- `full` - —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –∑–∞–Ω–æ–≤–æ

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ `client/public/images/`
2. –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ SSH
3. –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –≤ `dist/public/images/`
4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ —Å –∫–∞—Ä—Ç–∏–Ω–∫–∞–º–∏
- –ï—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

---

## GitHub Secrets (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã –¥–µ–ø–ª–æ—è:

| –°–µ–∫—Ä–µ—Ç | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|----------|
| `SSH_PRIVATE_KEY` | –°–æ–¥–µ—Ä–∂–∏–º–æ–µ ~/.ssh/parrot_shop_deploy | Ed25519 –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á |
| `SERVER_HOST` | `144.31.212.184` | IP –∞–¥—Ä–µ—Å VPS —Å–µ—Ä–≤–µ—Ä–∞ |
| `SERVER_USER` | `root` | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–ª—è SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è |
| `DEPLOY_PATH` | `/opt/parrot-shop` | –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ |

### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:

| –°–µ–∫—Ä–µ—Ç | –ó–Ω–∞—á–µ–Ω–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|----------|
| `TELEGRAM_BOT_TOKEN` | –¢–æ–∫–µ–Ω –∏–∑ @BotFather | –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π |
| `TELEGRAM_CHAT_ID` | ID —á–∞—Ç–∞ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π | –ì–¥–µ –ø–æ–ª—É—á–∞—Ç—å –∞–ª–µ—Ä—Ç—ã |

### –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å Secrets –≤ GitHub:

1. –ü–µ—Ä–µ–π—Ç–∏ –≤ **Settings** —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–ª–µ–≤–∞: **Secrets and variables** ‚Üí **Actions**
3. –ù–∞–∂–∞—Ç—å **New repository secret**
4. –ó–∞–ø–æ–ª–Ω–∏—Ç—å Name –∏ Value
5. –ù–∞–∂–∞—Ç—å **Add secret**

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–µ–ø–ª–æ—è

### ‚úÖ –ß—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç—Å—è:

- `dist/` - —Å–æ–±—Ä–∞–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- `package.json` –∏ `package-lock.json` - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- Production dependencies (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ)

### ‚ùå –ß—Ç–æ –ù–ï –¥–µ–ø–ª–æ–∏—Ç—Å—è (–æ—Å—Ç–∞–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ):

- `data/parrot_shop.db` - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–≤–∞–∂–Ω–æ!)
- `dist/public/images/` - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–æ—Ç–¥–µ–ª—å–Ω—ã–π workflow)
- `.env` —Ñ–∞–π–ª - —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –õ–æ–≥–∏ –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup

–ü–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –¥–µ–ø–ª–æ–µ–º —Å–æ–∑–¥–∞–µ—Ç—Å—è backup —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏:
```
/opt/parrot-shop_backup_20260131_120000/
/opt/parrot-shop_backup_20260131_114500/
```

–•—Ä–∞–Ω—è—Ç—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ 5 backups. –°—Ç–∞—Ä—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è.

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –ü—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –¥–µ–ø–ª–æ–µ–º:

1. **–ù–ï –ö–û–ú–ú–ò–¢–ò–¢–¨:**
   - ‚ùå –ü—Ä–∏–≤–∞—Ç–Ω—ã–µ SSH –∫–ª—é—á–∏ (*.pem, id_rsa, id_ed25519)
   - ‚ùå `.env` —Ñ–∞–π–ª—ã —Å —Å–µ–∫—Ä–µ—Ç–∞–º–∏
   - ‚ùå –ü–∞—Ä–æ–ª–∏ –≤ –ª—é–±–æ–º –≤–∏–¥–µ

2. **–ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨:**
   - ‚úÖ GitHub Secrets –¥–ª—è –≤—Å–µ—Ö credentials
   - ‚úÖ SSH –∫–ª—é—á–∏ –≤–º–µ—Å—Ç–æ –ø–∞—Ä–æ–ª–µ–π (ed25519)
   - ‚úÖ –ü—Ä–æ–≤–µ—Ä—è—Ç—å `.gitignore` –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º (`git status`)

3. **–ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞:**
   - –¢–æ–ª—å–∫–æ GitHub Actions –º–æ–∂–µ—Ç —á–∏—Ç–∞—Ç—å Secrets
   - –°–µ–∫—Ä–µ—Ç—ã –Ω–µ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –ª–æ–≥–∞—Ö
   - SSH –∫–ª—é—á —É–¥–∞–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –¥–µ–ø–ª–æ—è

### –ö–∞–∫ —Å–º–µ–Ω–∏—Ç—å SSH –∫–ª—é—á–∏:

```bash
# –ï—Å–ª–∏ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω –∫–ª—é—á:
1. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –ª–æ–∫–∞–ª—å–Ω–æ:
   ssh-keygen -t ed25519 -C "github-actions@parrot-shop-v2" -f ~/.ssh/parrot_shop_deploy_v2

2. –û–±–Ω–æ–≤–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
   ssh root@144.31.212.184
   nano ~/.ssh/authorized_keys
   # –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π –∫–ª—é—á, –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π

3. –û–±–Ω–æ–≤–∏—Ç—å –≤ GitHub Secrets:
   Settings ‚Üí Secrets ‚Üí SSH_PRIVATE_KEY
   # –í—Å—Ç–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∫–ª—é—á
```

---

## –û—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### –ï—Å–ª–∏ –¥–µ–ø–ª–æ–π –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è:

**GitHub Actions –ø–æ–∫–∞–∂–µ—Ç –æ—à–∏–±–∫—É –≤ step-–µ. –î–µ–π—Å—Ç–≤–∏—è:**

1. **–ü—Ä–æ—á–∏—Ç–∞—Ç—å –ª–æ–≥–∏** (–∫–∞–∫–æ–π step –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è)
2. **–û—Ç–∫–∞—Ç–∏—Ç—å—Å—è –≤—Ä—É—á–Ω—É—é:**
   ```bash
   ssh root@144.31.212.184
   cd /opt
   systemctl stop parrot-shop
   mv parrot-shop parrot-shop_failed_$(date +%s)
   mv parrot-shop_backup_<timestamp> parrot-shop
   systemctl start parrot-shop
   ```
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å:**
   ```bash
   systemctl status parrot-shop
   journalctl -u parrot-shop -n 50
   ```

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è:

**"SSH connection failed"**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `SSH_PRIVATE_KEY` –≤ Secrets (–¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∏ BEGIN/END)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: `cat ~/.ssh/authorized_keys`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å SSH –ø–æ—Ä—Ç (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 22)

**"Build failed"**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Node.js –≤–µ—Ä—Å–∏—é (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å 20)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å TypeScript –æ—à–∏–±–∫–∏ –ª–æ–∫–∞–ª—å–Ω–æ: `npm run check`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å—Ç—å –ª–∏ `package-lock.json` –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

**"npm ci failed"**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `package-lock.json` –Ω–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∞
- –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é: `npm ci --prefer-offline`

**"Service failed to start"**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `ssh root@144.31.212.184 "journalctl -u parrot-shop -n 50"`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `.env` —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ: —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ `DATABASE_PATH`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `data/`: `ls -la /opt/parrot-shop/data`

**"API health check failed"**
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –¥–æ–ª–≥–æ —Å—Ç–∞—Ä—Ç–æ–≤–∞—Ç—å (—É–≤–µ–ª–∏—á–∏—Ç—å `sleep` –≤ workflow)
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é: `sudo nginx -t`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å firewall –ø—Ä–∞–≤–∏–ª–∞: `sudo ufw status`

---

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–µ–ø–ª–æ—è

### –ß–µ—Ä–µ–∑ GitHub Actions UI:

1. –û—Ç–∫—Ä—ã—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. –ü–µ—Ä–µ–π—Ç–∏ –≤ **Actions**
3. –í—ã–±—Ä–∞—Ç—å workflow "Deploy to VPS"
4. –í—ã–±—Ä–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–∞–ø—É—Å–∫
5. –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –∫–∞–∂–¥–æ–≥–æ step
6. –ù–∞–∂–∞—Ç—å –Ω–∞ step –¥–ª—è –¥–µ—Ç–∞–ª–µ–π

### –ß–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ):

```bash
# –°–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
ssh root@144.31.212.184 "journalctl -u parrot-shop -f"

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤
ssh root@144.31.212.184 "journalctl -u parrot-shop -n 50"

# –°—Ç–∞—Ç—É—Å —Å–µ—Ä–≤–∏—Å–∞
ssh root@144.31.212.184 "systemctl status parrot-shop"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å Node.js
ssh root@144.31.212.184 "ps aux | grep 'node.*index.cjs'"

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
curl http://144.31.212.184/api/products

# Health check endpoint
curl http://144.31.212.184/health
```

---

## –ß–∞—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏

### –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–ø–ª–æ–π –≤—Ä—É—á–Ω—É—é:

1. GitHub ‚Üí **Actions**
2. "Deploy to VPS" workflow
3. –ù–∞–∂–∞—Ç—å **Run workflow**
4. –í—ã–±—Ä–∞—Ç—å –≤–µ—Ç–∫—É (–æ–±—ã—á–Ω–æ `main`)
5. –ù–∞–∂–∞—Ç—å **Run workflow**

### –ó–∞–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è:

1. GitHub ‚Üí **Actions**
2. "Deploy Images Only" workflow
3. –ù–∞–∂–∞—Ç—å **Run workflow**
4. –í—ã–±—Ä–∞—Ç—å sync type:
   - `incremental` - –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ (–±—ã—Å—Ç—Ä–µ–µ)
   - `full` - –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ (–º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ)
5. –ù–∞–∂–∞—Ç—å **Run workflow**

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
ssh root@144.31.212.184 "cat /opt/parrot-shop/package.json | grep version"

# –ò–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
ssh root@144.31.212.184 "ls -la /opt/parrot-shop/ | head -20"
```

### –û—Ç–∫–∞—Ç–∏—Ç—å –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏:

```bash
# –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö backups
ssh root@144.31.212.184 "ls -la /opt/parrot-shop_backup_* | tail -5"

# –û—Ç–∫–∞—Ç
ssh root@144.31.212.184 << 'EOF'
cd /opt
systemctl stop parrot-shop
mv parrot-shop parrot-shop_current_broken
mv parrot-shop_backup_20260131_120000 parrot-shop  # –í—ã–±—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–π backup
systemctl start parrot-shop
systemctl status parrot-shop
EOF
```

### –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ backups –≤—Ä—É—á–Ω—É—é:

```bash
ssh root@144.31.212.184 << 'EOF'
cd /opt
ls -dt parrot-shop_backup_* | tail -n +6 | xargs rm -rf
ls -la parrot-shop_backup_* | wc -l
EOF
```

---

## Best Practices

### 1. **–í—Å–µ–≥–¥–∞ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ –ø–µ—Ä–µ–¥ push**

```bash
npm run check      # TypeScript –ø—Ä–æ–≤–µ—Ä–∫–∞
npm run build      # –ü–æ–ª–Ω–∞—è —Å–±–æ—Ä–∫–∞
npm start          # –õ–æ–∫–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç
```

### 2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ feature branches**

```bash
git checkout -b feature/my-feature
# ... –¥–µ–ª–∞–µ—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è ...
git commit -m "..."
git push origin feature/my-feature
# –°–æ–∑–¥–∞—ë—Ç–µ PR –Ω–∞ GitHub –¥–ª—è code review
```

### 3. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ `.gitignore` –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º**

```bash
git status  # –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö —Ñ–∞–π–ª–æ–≤
# –û—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–µ—Ç –ª–∏:
# - .env —Ñ–∞–π–ª–æ–≤
# - SSH –∫–ª—é—á–µ–π
# - node_modules
# - dist/
```

### 4. **–ü–∏—à–∏—Ç–µ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ commit messages**

```
‚ùå –ü–ª–æ—Ö–æ: "fix"
‚úÖ –•–æ—Ä–æ—à–æ: "Fix API endpoint to return correct product count"

‚ùå –ü–ª–æ—Ö–æ: "update"
‚úÖ –•–æ—Ä–æ—à–æ: "Update build process to optimize bundle size"
```

### 5. **–ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è**

```bash
# –ü–µ—Ä–≤—ã–µ 5 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏
ssh root@144.31.212.184 "journalctl -u parrot-shop -f"

# –ò–ª–∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∑–¥–æ—Ä–æ–≤—å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
watch -n 5 'curl -s http://144.31.212.184/health | jq .'
```

### 6. **–ù–µ –¥–µ–ø–ª–æ–π—Ç–µ –≤ –ø–ª–æ—Ö–æ–µ –≤—Ä–µ–º—è**

- –ï—Å–ª–∏ –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ –±—ã—Å—Ç—Ä–æ –æ—Ç–∫–∞—Ç–∏—Ç—å—Å—è –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö
- –ï—Å–ª–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏–¥—É—Ç –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î
- –ë–ª–∏–∂–µ –∫ –∫–æ–Ω—Ü—É —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è –±–µ–∑ —Å—É–ø–æ—Ä—Ç–∞

### 7. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ `TELEGRAM_BOT_TOKEN` –∏ `TELEGRAM_CHAT_ID` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —É—Å–ø–µ—à–Ω—ã—Ö/–Ω–µ—É–¥–∞—á–Ω—ã—Ö –¥–µ–ø–ª–æ—è—Ö.

---

## –ü–ª–∞–Ω—ã –Ω–∞ –±—É–¥—É—â–µ–µ

- [ ] Staging environment –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (develop ‚Üí staging, main ‚Üí production)
- [ ] Automated tests –≤ CI pipeline (–ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º)
- [ ] Database migrations –≤ workflow
- [ ] Docker containerization –¥–ª—è –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è
- [ ] Blue-Green deployment –¥–ª—è zero-downtime
- [ ] Automatic rollback –ø—Ä–∏ health check failure
- [ ] Notification –≤ Slack –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∫ Telegram
- [ ] Performance monitoring –∏ –º–µ—Ç—Ä–∏–∫–∏

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `.github/workflows/deploy.yml` - –æ—Å–Ω–æ–≤–Ω–æ–π workflow
- `.github/workflows/deploy-images.yml` - workflow –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- `.env.example` - —à–∞–±–ª–æ–Ω –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `server/routes.ts` - –µ—Å—Ç—å `/health` endpoint –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è
- `package.json` - —Å–∫—Ä–∏–ø—Ç—ã: `build`, `start`, `check`
